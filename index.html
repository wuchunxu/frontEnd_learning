<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>wuchunxu的前端笔记</title>
	<link rel="stylesheet" href="css/base.css">
	<link rel="stylesheet" href="css/main.css">

</head>
<body>
	
	<nav>
		<div class="logo">前端学习笔记</div>
	</nav>
	<h1>巫春旭的前端学习笔记</h1>

	<p><em>注意：内容更新Server、PHP、CSS、JS高级</em></p>
	<main>
		 <div class="content"></div>
	</main>
	
	 <!-- <table class="table-1"></table> -->
	<div id="shower"></div>
	<div id="layer"></div>
	<script src="js/util.js"></script>
	<script>
		(function(){
			var content = document.getElementsByClassName("content")[0];
			var frontEnd = {
				period_1: {
					"熟悉服务端": ["软件工程","服务器和数据库","PHP"],
				},
				period_2: {
					"初入前端" : ["HTML5基础(未更新)","JS基础(未更新)","Ajax(未更)","CSS","CSS3"],
				},
				period_3: {
					"前端之JS高级" : ["JS内置类型","Function","面向对象","ES5","ES6"],
					"DOM和BOM": ["DOM","BOM"]
				}
			}
			/*
			function toTable(frontEnd){
				var html = "";
				var flag = true;
				for(let period in frontEnd ){
					flag = true;
					for (var day in frontEnd[period] ){
						if(flag){
							html += `<tr><td rowspan="${Object.keys(frontEnd[period]).length}">阶段${period.slice(period.length-1)}</td><td>${day}</td><td>`;
							flag = false;
						}else{

							html += `<tr><td>${day}</td><td>`;
						}
						for ( var ele of frontEnd[period][day] ){
							html += `<div class="item"><img src="images/icon/${ele}.png"><p>${ele}</p></div>`;
						}
						html +='</td></tr>';
					}
				}
				return html;
			}
			*/
			//展示数据
			content.innerHTML = (function(frontEnd){
				var html = "";
				for(var period in frontEnd){
					html += "<section>";
					html += `<h2>·阶段${period.slice(period.length-1)}·</h2>`;
					for(var section in frontEnd[period]){
						html += `<h3>${section}</h3>`;
						html += "<div class='clear'>";
						for(var ele of frontEnd[period][section]){
							html += `<div class="item"><img src="images/icon/${ele}.png"><p>${ele}</p></div>`;
						}
						html += "</div>";
					}
					html += "</section>";
				}
				return html;
			})(frontEnd);

			content.onclick = function show(e){
				if(!(e.target.hasClass("item")||e.target.parentNode.hasClass("item"))) return false;
				
				var url = `resource/${e.target.closest("div").getElementsByTagName("p")[0].innerHTML}.html`;
				
				ajax(url,{
					success:function(resposneText){

						var modal = $("shower");
						modal.innerHTML = resposneText;
						modal.style.display = "block";
						$("layer").style.display = "block";
						
						modal.getElementsByClassName("menu")[0].onclick = function(event){
							var parent = event.target.closest("li");
							var lis = parent.parentNode.children;
							
							lis = [].filter.call(lis,ele=>ele.tagName.toUpperCase()==="LI");
							var descs = parent.parentNode.getElementsByClassName("desc");
							var desc =  parent.getElementsByClassName("desc")[0];
							if(event.target.tagName.toUpperCase()=="P"&&event.target.parentNode.tagName.toUpperCase()=="LI"){
								if (desc.style.display=="block"){
									desc.style.display = "none";
									parent.firstElementChild.removeClass("active");
								}else {
									//去除所有p的active，并把desc的display属性设为none
									for(let ele of lis){
										ele.firstElementChild.removeClass("active");
									}
									for(let ele of descs){
										ele.style.display = "none";
									}
									parent.firstElementChild.addClass("active");
									desc.style.display = "block";
								}
							}
						}
					}
				});
			}
			$("layer").onclick = function(){
				this.style.display = "none";
				$("shower").style.display = "none";
			}
		})();

		
		var table_select = function(){
			//首先拿到全选按钮
			var selectAll = document.querySelector("#select-all>thead>tr>th:first-child>input");
			var checkboxes = document.querySelectorAll("#select-all>tbody>tr>td:first-child>input");
			console.log(selectAll);
			selectAll.onclick = function(){
				for(var ele of checkboxes){
					ele.checked = selectAll.checked;
				}
			}
			//全选和单选的点击事件处理逻辑
			var table_click = function(){
				if(this.checked){
					var unchecked = document.querySelector(
						"table>tbody>tr>td:first-child>input:not(:checked)"
					);
					if(!unchecked) selectAll.checked = true;
				}else {
					selectAll.checked = false;
				}
			}
			for(var ele of checkboxes){
				ele.onclick = table_click;
			}
		}
		
	</script>
</body>
</html>