<h2>PHP</h2>
<ul class="menu">
	<li>
		<p>面试题-如何自学一门新语言</p>
		<div class="desc">
			<h2>如何自学一门新语言</h2>
			<h3>了解背景、历史、现状、应用领域</h3>
			<h3>搭建开发运行环境，输出Hello World</h3>
			<h3>变量和常量</h3>
			<h3>数据类型</h3>
			<h3>运算符</h3>
			<h3>逻辑结构</h3>
			<h3>通用小程序</h3>
			<p>判断是否为闰年、打星星、九九乘法表、水仙花数、质数</p>
			<h3>函数和对象</h3>
			<h3>第三方库、组件、框架</h3>
			<h3>实用小项目</h3>
		</div>
	</li>
	<li>
		<p>PHP背景知识</p>
		<div class="desc">
			<h2>PHP背景知识</h2>
			<h3>web服务器</h3>
			<h4>功能</h4>
			<p>接收客户端请求，返回需要的资源（HTML、CSS、JS、图片、音频、视频、数据库、其他服务器）</p>
			<h4>静态web服务器</h4>
			<p>任何人、任何时间，访问相同的内容</p>
			<h4>动态web服务器</h4>
			<p>不同的人、不同的时间，访问的内容可能发生变化</p>
			<p>动态web技术有：jsp、php、asp.net、Python、Node.js</p>
			<h3>了解PHP背景</h3>
			<p>1994年，Personal Home Page，用于统计自己网页的访问数量。</p>
			<p>1999年，Zend公司商业化维护该语言，更名为PHP is Hypertext Preprocessor</p>
			<p>开源、简单、跨平台、占内存小、尤其适用于中小型、需要快速开发的WEB项目</p>
			<h3>LAMP</h3>
			<p>Linux+Apache+MySQL+PHP</p>
		</div>
	</li>
	<li>
		<p>PHP环境搭建</p>
		<div class="desc">
		<h2>PHP环境的搭建</h2>
		<ol>
			<li>下载并安装静态服务器，如Apache</li>
			<li>下载并安装PHP解释器</li>
			<li>PHP与WEB服务器整合</li>
			<li>启动WEB服务器</li>
		</ol>
			注：前3步可以使用XAMPP套装一次性安装完成
		</div>
	</li>
	<li>
		<p>基础知识</p>
		<div class="desc">
			<h2>PHP基础知识</h2>
			<h3>变量和常量</h3>
			<pre class="code"><span class="note">//变量</span>
$num = 1;
<span class="note">常量</span>
const PI = 3.14;
			</pre>
			<h3>数据类型</h3>
			<table>
				<tr><td>标量类型</td><td>boolean、int、float、double、string</td></tr>
				<tr>
					<td>复合类型</td>
					<td>array、object</td>
				</tr>
				<tr>
					<td>其他类型</td>
					<td>null<br>resource,如$conn</td>
				</tr>
			</table>
			<h3>运算符</h3>
			<table>
				<tr><td rowspan="3">算术运算符</td><td>%</td><td>取模，也就是求余数</td></tr>
				<tr><td rowspan="2">++</td><td>$i++</td><td>先取值，再自增</td></tr>
				<tr><td>++$i</td><td>先自增，再取值</td></tr>
				<tr><td rowspan="3">比较运算符</td><td rowspan="3"> >和< </td><td>12>3</td><td></td></tr>
				<tr><td>"12">"3"</td><td>隐式转换为整型再比较</td></tr>
				<tr><td>"abc" < "abd"</td><td>不转换，Unicode码比较大小</td></tr>
				<tr><td>逻辑运算符</td><td colspan="3"></td></tr>
				<tr><td rowspan="2">位运算符</td><td>&lt;&lt;</td><td>&lt;&lt;N</td><td>按位左移N位，相当于乘以2的N次方</td></tr>
				<tr><td>&gt;&gt;</td><td>&gt;&gt;N</td><td>按位右移N位，相当于除以2的N次方</td></tr>
				<tr><td rowspan="2">赋值运算符</td><td rowspan="2">=</td><td>$score = $score+5;</td><td></td></tr>
				<tr><td>$score += 5;</td><td>性能更优，不重新开辟内存</td></tr>
				<tr><td rowspan="2">拼接运算符</td><td>.</td><td></td><td></td></tr>
				<tr><td>.=</td><td></td><td></td></tr>
				<tr><td>三目运算符</td><td></td><td colspan="2">$result = (条件)?option1:option2;</td></tr>
			</table>
			<h3>数组</h3>
			<table>
				<tr><td rowspan="2">索引数组</td><td>创建数组</td><td>$price= [150,200];</td></tr>
				<tr><td>添加元素</td><td><span class="code">$price[]=130;</span></td></tr>
				<tr>
					<td>关联数组</td><td>创建数组</td>
					<td>
						<pre class="code">$emp = [
	'eid'=>1101,
	'ename'=>'tom',
	'salary'=>3000
];</pre>
					</td>
				</tr>
			</table>
			<h3>foreach循环</h3>
			<h3>预定义数组</h3>
			<h3>函数</h3>
			<h3>小知识点</h3>
			<h4>单引号和双引号</h4>
			<pre class="code"><span class="note">注意以下区别：</span>
$msg = '姓名：$uname';
$msg = "姓名：$uname";<span class="note">#双引号内，$uname被当成变量，而其中的单引号就是普通的字符串</span> </pre>
			<h4>PHP中的“+”</h4>
			<p>PHP中的“+”只用来做算术运算，字符串拼接用“<span class="code">.</span>”</p>
		</div>
	</li>
	<li>
		<p>PHP操作数据库</p>
		<div class="desc">
			<h2>PHP操作数据库</h2>
			<h3>PHP连接MySQL</h3>
			<p>通常在init.php文件中拿到数据库连接，并设置连接的编码格式UTF8</p>
			<pre class="code"><span class="note">//init.php</span>
$conn = $mysqli_connect("127.0.0.1","root","","xz",3306);
mysqli_query($conn,"SET NAMES UTF8");</pre>
			<h3>基于表单的CRUD</h3>
			<h4>增加数据--向数据库插入数据</h4>
			<pre class="code">

			</pre>
			<h4>查询的应用--判断用户名和邮箱是否被占用</h4>
			<pre class="code">
/*
	vali.php
	判断用户名、邮箱是否已被占用
 *
require_once("init.php");
@$uname = $_REQUEST["uname"];
@$email = $_REQUEST["email"];


function vali($result){
	if($result){
		$row = mysqli_fetch_assoc($result);
		if($row){
			echo "false";
		}else{
			echo "true";
		}
	}
}
if($uname){
	$sql = "SELECT uid FROM xz_user WHERE uname='$uname'";
	$result = mysqli_query($conn,$sql);
	vali($result);
}

if($email){
	$sql = "SELECT uid FROM xz_user WHERE email='$email'";
	$result = mysqli_query($conn,$sql);
	vali($result);
}
 </pre>
			<h3>文件上传</h3>
			<h4>前端处理</h4>
			<h5>方式一：普通form上传</h5>
			<pre class="code">
 &lt;form id="form1" method="post" enctype="multipart/form-data" action="upload_file.php" &gt;
      &lt;label&gt;选择本地文件:
        &lt;input type="file" name="sqlfile"/&gt;
      &lt;/label&gt;
      &lt;br/&gt;
      &lt;input type="submit" name="submit" value="Submit" /&gt;
&lt;/form&gt;</pre>
			<h5>方式二：ajax异步上传文件</h5>
			<pre class="code"><span class="note">//这里调用jQuery中的ajax函数</span>
$("input:button").click(function(){
  $.ajax({
	url:"upload_file.php",
	type:"post",
	data:new FormData($("#form1")[0]),<span class="note">//将form中的数据打包成对象</span>
	processData:false,<span class="note">//不要处理数据</span>
	contentType:false
  }).then(()=>{
	alert("上传成功");
  });
});</pre>
			<p>前端文件表单点击submit提交后，文件即上传到服务器。在还未指定如何处理该文件时，该文件临时存储在xampp/tmp文件夹中。如果PHP中未处理该文件，并且PHP脚本已经执行完毕，那么该临时文件就会自动删除。</p>
			<pre class="code">$file = $_FILES["sqlfile"];
move_uploaded_file($file["tmp_name"], "upload/".$file["name"])<span class="note">//将临时文件移动到指定文件夹下</span></pre>

			<h3>phpMyAdmin</h3>
			<h3>常见的错误</h3>
		</div>
	</li>
	<li>
	    <p>php登录功能</p>
	    <div class="desc">
			<h2>后端登录功能</h2>
            <pre class="code"><span class="note">//修改响应的数据格式为json</span>
header("Content-Type:application/json;charset=UTF-8");

@$aname = $_REQUEST["aname"];
@$apwd = $_REQUEST["apwd"];
<span class="note">/*
	创建正则表达式进行验证
	aname 字母或数字 3~12
	apwd 字母或数字 3~12
*/</span>
$reg = '/^[a-zA-Z0-9]{3,12}$/';
$rs = preg_match($reg,$aname);

if(!$rs){
  die('{"code":-1,"msg":"用户名格式有误，请检查"}');
}
$rs = preg_match($reg,$apwd);
if(!$rs){
  die('{"code":-1,"msg":"密码格式有误，请检查"}');
}

//连接数据库
$conn = mysqli_connect("127.0.0.1","root","","xz",3306);
mysqli_query($conn,"SET NAMES UTF8");
//创建sql语句查询xz_admin中是否存在此记录
$sql = "SELECT aid FROM `xz_admin` WHERE aname = '$aname' AND binary apwd = md5('$apwd')";

<span class="note">//发送sql语句，并获取返回的结果</span>
$result = mysqli_query($conn,$sql);
<span class="note">//如果出错，输出错误信息</span>
if(mysqli_error($conn))  echo mysqli_error($conn);

$row = mysqli_fetch_row($result);
if(!$row){
  echo '{"code":-1,"msg":"用户名或密码有误"}';
}else{
  echo '{"code":1,"msg":"登录成功"}';
}
/*
  ----------实际开发中的特殊需求-------------
  1、所有表添加4列
  cuid ctime {创建记录用户编号，创建时间} INSERT
  muid mtime {修改记录用户的编号，修改时间} UPDATE
  2、所有记录不允许DELETE操作
  isdel       {0正常数据 1已经被删除}
*/</pre>
        </div>
	</li>
	<li>
	    <p>PHP错误集锦</p>
	    <div class="desc">
	        <h2>PHP错误集锦</h2>
	        <h3>header中的错误</h3>
	        <pre class="code">header("Content-Type:application/json;charset=UTF-8");</pre>
	        <p>声明头信息不能有任何错误，否则可能出现<em>乱码/下载/发送json错误</em></p>
	        <h3>json格式书写错误</h3>
	        <pre class="code">echo '{"code":1,"msg":"登录成功"}';
<span class="note">//以下是错误写法,json里写了单引号</span>
echo "{'code':1,'msg':'登录成功'}";</pre>
			<p>当json格式书写错误，ajax无法识别该错误，视为服务器出错，因此，很难调试。这时候查看response响应数据就可以查找到错误。</p>
			<h3>清空缓存</h3>
			<p>编码时，<span class="code"> Chrome F12--Network--disable cache</span>禁用缓存，可避免一些不必要的错误。</p>
        </div>
	</li>
	<li>
		<p>实际开发中的知识</p>
		<div class="desc">
			<h2>实际开发中的知识</h2>
			<h3>特殊需求</h3>
			<h4>所有表添加4列</h4>
			<pre class="code">
----------实际开发中的特殊需求-------------
1、所有表添加4列
cuid ctime {创建记录用户编号，创建时间} INSERT
muid mtime {修改记录用户的编号，修改时间} UPDATE
2、所有记录不允许DELETE操作
isdel       {0正常数据 1已经被删除}
$sql = "SELECT aid FROM `xz_admin` WHERE aname = '$aname' AND binary apwd = md5('$apwd') AND isdel=0";
3、为了适应项目的扩展性，习惯添加几列--备用
vi1 vi2 INT
vs1 vs2 VARCHAR(255)
ALTER TABLE xz_admin ADD isdel INT;
表格数据很多的时候，添加列十分耗费性能，100w条记录添加列至少消耗1h
如果项目中有查询非常频繁数据，而且要求查询速度快，那么将数据复制一份到redis，程序查询redis
redis查询速度快，每秒2w，mysql只有25</pre>
				

		</div>
	</li>
	<li>

		<p>Session</p>
		<div class="desc">
			<h2>Session</h2>
			<h3>为什么要用Session</h3>
			<p>HTTP连接的<em>无状态性</em>，决定了用户每执行一次操作，都要与服务器重新建立连接。这样做的优点是，能快速释放资源给其他用户，增大了服务器的负载能力。然而缺点也显而易见，即同一个用户建立新连接时，无法获取上次连接的状态和数据。</p>
			<h3>Session</h3>
			<p>Session用来弥补http无状态的缺陷--无法保持数据。如果你看过《记忆碎片》，你就会知道，如果一个人无法记忆应该怎么解决--用笔记下来就好了。事实上，服务器也是这么做的，它只是将信息“记忆”(保存)在叫Session的对象中。PHP中，Session是关联数组对象，有了它，整个会话过程中服务器就可以保持数据了。</p>
			<p>会话是指用户在浏览网站时，从进入该网站到关闭浏览器所经过时间。</p>
			<h3>Session的生命周期</h3>
			<table>
				<tr>
					<td>1</td>
					<td><p>用户打开浏览器首次请求服务器时，浏览器与服务器建立一个session（有必要创建时才创建，由java或php编程控制）。服务器自动给客户端分配一个唯一的标识(sessionid)，存储于客户端本地的cookie中。注意：从当前浏览器窗口再打开新链接，不再建立新的session，而是和第一个打开的窗口共用一个session。</p></td>
				</tr>
				<tr>
					<td>2</td>
					<td><p>当PHP调用session_start()函数时，服务器会根据请求中携带的SessionId，从session仓库中加载对应SessionId的session对象到内存中。</p></td>
				</tr>
				<tr>
					<td>3</td>
					<td><p>注册session变量:<span class="code">session_start();$_SESSION["变量名"]=值;//用法同关联数组</span></p></td>
				</tr>
				<tr>
					<td>4</td>
					<td><p>当PHP脚本执行完毕，未被销毁的session变量会临时保存到服务器本地一个指定路径session库中，当需要再次访问session中保存的数据时，可以从session库中加载回内存使用。这个路径可以通过php.ini文件中session.save_path指定</p></td>
				</tr>
				<tr>
					<td>5</td>
					<td><p>只要页面有提交活动，则Session所有项会保持</p></td>
				</tr>
				<tr>
					<td>6</td>
					<td><p>Session失效：页面在1440s后，若没有任何提交活动，就会失效。php.ini中<span class="code">session.gc_maxlifetime = 1440;</span></p></td>
				</tr>
			</table>
			<h3>PHP中使用session</h3>
			<h4>启动session</h4>
			<p>根据sessionId，从硬盘中读取session到内存中的过程叫启动session。</p>
			<pre class="code">session_start()</pre>
			<p>首次调用时，php会自动创建session文件。</p>
			<h4>向session中注册变量</h4>
			<pre class="code">$_SESSION["uid"] = $uid;</pre>
			<p>注意：session中只存id和简单的数据类型。如果存入session的是对象，则读取时，会被反序列化为内存中的对象。不建议存对象。</p>
			<h4>销毁session</h4>
			<pre class="code"><span class="note">//销毁一个变量</span>
unset($_SESSION["变量名"])
<span class="note">//销毁当前用户整个session</span>
session_unset();//释放内存
session_destroy();//销毁文件
			</pre>
			<h4>永久session</h4>
			<p>方法1：修改php.ini，<span class="code">session.gc_maxlifetime=9999</span></p>
			<p>方法2：客户端自动定时刷新</p>
			<pre class="code">$(function(){
	setInterval(function(){
		$.getJSON("/");
	},30*1000);
})</pre>

		</div>
	</li>
</ul>